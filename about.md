

**מטרת הפרויקט:**

הפרויקט `gingim-video-cover` נועד להזריק קוד JavaScript לאתרי אינטרנט המארחים משחקי ילדים, כך שיוצג סרטון לאחר סיום שלב במשחק.  הקוד מזהה את הפונקציה במשחק שאחראית על סיום השלב, עוטף אותה בקוד נוסף, ומפעיל את הסרטון לאחר שהפונקציה המקורית מסיימת את פעולתה.  הפרויקט תומך במגוון משחקים ומספק מנגנון גמיש להגדרת פרמטרים כמו משך הסרטון ועיכוב לפני ההפעלה.

**אופן הפעולה:**

1. **הזרקת קוד:** הקוד מתחיל בהזרקת קובץ JavaScript ראשי (`main.js` או `app-booster.js`) לאתר היעד.  ההזרקה מתבצעת באמצעות יצירת תג `<script>` דינמית והוספתו ל- `document.head`.  הקוד מטפל גם במקרים בהם המשחק מוטמע בתוך iframe, ומזריק את עצמו לתוך ה-iframe כדי להבטיח שהסרטון יוצג.

2. **זיהוי משחק:**  לאחר הטעינה, הקוד מזהה את המשחק הספציפי שרץ בדפדפן על ידי בדיקת ה-URL.  הוא משתמש בקובץ הגדרות (`src/core/config.js`) המכיל מידע על משחקים שונים, כולל נתיב ה-URL שלהם והפונקציה שאחראית על סיום השלב.

3. **חיפוש פונקציית סיום שלב:**  לאחר זיהוי המשחק, הקוד מחפש את הפונקציה הספציפית שאחראית על סיום השלב.  הוא עושה זאת באמצעות שילוב של חיפוש לפי נתיב (באמצעות `getFunctionByPath`) וחיפוש גלובלי (באמצעות `searchFunInGlobal`).

4. **עטיפת הפונקציה:**  לאחר שפונקציית סיום השלב נמצאה, הקוד עוטף אותה בפונקציה חדשה.  הפונקציה החדשה קוראת לפונקציה המקורית, ולאחר מכן מפעילה את הסרטון.

5. **הצגת הסרטון:**  הקוד יוצר אלמנט `<video>` דינמית ומציג אותו על המסך.  הוא כולל גם לוגיקה לטיפול בעוצמת השמע (fade in/fade out) ולסגירת הסרטון לאחר סיום ההפעלה.

**ארכיטקטורה:**

הקוד מאורגן במספר קבצים:

* `src/main.js`:  קובץ הכניסה הראשי להפעלת סרטונים.
* `src/app-booster.js`: קובץ כניסה להפעלת אפליקציות (לא רלוונטי להפעלת סרטונים).
* `src/core/injection.js`:  פונקציות להזרקת קוד.
* `src/core/config.js`: הגדרות משחקים.
* `src/core/utils.js`: פונקציות עזר.
* `src/core/video.js`: לוגיקה לטיפול בסרטונים.


**יתרונות:**

* **גמישות:**  הקוד תומך במגוון משחקים ומאפשר הגדרה קלה של פרמטרים.
* **אוטומטי:**  התהליך כולו אוטומטי, החל מזיהוי המשחק ועד להצגת הסרטון.
* **תחזוקה:**  הקוד מאורגן בצורה מודולרית, מה שמקל על תחזוקה והוספת פיצ'רים חדשים.

**חסרונות:**

* **תלוי במבנה של אתרי המשחקים:**  שינויים במבנה האתרים עלולים לשבור את הקוד.
* **אפשרות חסימה:**  אתרי המשחקים עלולים לחסום את הקוד או לזהות אותו כקוד זדוני.

