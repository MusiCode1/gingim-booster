# יומן שינויים

השינויים מסודרים בסדר כרונולוגי הפוך - השינויים האחרונים מופיעים בתחילת הקובץ.


## [03/03/2025]
### שינוי: יישום מערכת ההגדרות החדשה בקוד

- **פירוט טכני**:
  - עדכון קבצי המערכת לשימוש במבנה ההגדרות החדש:
    - עדכון `src/main.ts` לאתחול מערכת ההגדרות בתחילת הריצה
    - עדכון `src/UI/component-composer.ts` לשימוש בפונקציות החדשות מ-`config-manager.ts`
    - עדכון `src/lib/game-handler.ts` לתמיכה במבנה החדש
    - עדכון `src/global.d.ts` לתמיכה בשני פורמטים של הגדרות
  - הוספת בדיקת אתחול למערכת ההגדרות ב-`config-manager.ts`
  - שיפור תהליך האתחול של מערכת ההגדרות

## [03/03/2025]
### שינוי: ריפקטורינג של מערכת ההגדרות והפרדת לוגיקת טעינת הסרטונים

- **פירוט טכני**:
  - יצירת מבנה חדש לאובייקט התצורה (Config) עם הפרדה לתתי-אובייקטים לוגיים (`src/types.ts`).
  - הוספת טיפוסים ייעודיים `VideoItem` ו-`VideoList` לשימוש עקבי במבנה נתוני הסרטונים (`src/types.ts`).
  - יצירת מודול נפרד לטעינת סרטונים (`src/lib/video-loader.ts`) עם פונקציות ייעודיות לטעינה ממקורות שונים.
  - שיפור הטיפול ב-mimeType עם זיהוי דינמי של סוג הקובץ לפי הסיומת.
  - עדכון מודול ניהול ההגדרות (`src/lib/config-manager.ts`) לשימוש בפונקציות החדשות.
  - הרחבת התיעוד של מבנה ההגדרות החדש (`documentation/new-config-structure.md`).

- **למה**:
  - שיפור ארגון הקוד על ידי הפרדת אחריות ברורה בין ניהול ההגדרות לטעינת הסרטונים.
  - שיפור קריאות הקוד ותחזוקתיות על ידי שימוש בטיפוסים מוגדרים היטב.
  - הוספת גמישות למערכת על ידי תמיכה בסוגי קבצים שונים וזיהוי דינמי של סוג הקובץ.
  - שיפור התיעוד והנגשת המידע על מבנה ההגדרות החדש ואופן השימוש בו.

- **השפעות**:
  - מבנה הגדרות מודולרי יותר שקל להרחיב בעתיד.
  - קוד קריא ותחזוקתי יותר עם הפרדת אחריות ברורה.
  - טיפול טוב יותר בסוגי קבצים שונים.
  - API פשוט ואינטואיטיבי לעבודה עם ההגדרות.
  - תמיכה בתאימות לאחור עם הקוד הקיים באמצעות פונקציות המרה.

## [27/02/2025]
### שינוי: שיפור תהליך הפיתוח ומעבר לשרת פיתוח מקומי

- **פירוט טכני**:
  - עדכון תצורת הפרויקט למעבר משרת ייצור לשרת פיתוח מקומי (`public/i.js`). שונה ה-URL מ-vercel.app ל-dev-server.dev:443.
  - הוספת פלאגין Vite חדש להזרקת סקריפטים (`vite.config.ts`, `vite-plugin/vite-plugin-inject-script.ts`).
  - שיפור הגדרות TypeScript (`tsconfig.json`): ביטול allowJs ו-checkJs לשיפור הביצועים.
  - עדכון דף index.html לטעינה דינמית של קוד ההזרקה (`public/index.html`).
  - תיקון שגיאת תחביר ב-`src/lib/google-drive-video.ts`.
  - שיפור קוד ב-`src/lib/get-game-config.ts`: שימוש בנתיב דינמי מהקונפיגורציה במקום ערך קבוע.
  - הוספת חבילת @types/node לתמיכה טובה יותר בסביבת Node (`package.json`).
  - עדכון .gitignore להתעלמות מקבצי הרשאות Google Drive וקבצי פיתוח.
  - ניקוי קבצים מיותרים: i.js ו-user-script-inject.js.
  - עדכון הגדרות שרת הפיתוח ב-`vite.config.ts` לשימוש בפורט 443.

- **למה**:
  - שיפור תהליך הפיתוח על ידי מעבר לשרת פיתוח מקומי, המאפשר בדיקות מהירות יותר ללא תלות בשרת חיצוני.
  - שיפור ארגון הקוד והתאמתו לסטנדרטים של TypeScript.
  - הוספת פלאגין להזרקת סקריפטים לשיפור תהליך הבנייה והפריסה.
  - תיקון שגיאות ושיפור הקוד הקיים.
  - שיפור חווית המשתמש בדף index.html על ידי טעינה דינמית של קוד ההזרקה.

- **השפעות**:
  - תהליך פיתוח מהיר ויעיל יותר עם פחות תלות בשרתים חיצוניים.
  - שיפור באיכות הקוד ובביצועים של המערכת.
  - הקטנת הסיכון לשגיאות בזמן ריצה על ידי שימוש בבדיקות טיפוסים מחמירות יותר.
  - שיפור בתהליך הבנייה והפריסה של המערכת.

## [27/02/2025]
### שינוי: הוצאת קוד משותף לקומפוננטות, תמיכה בהפעלת אפליקציות חיצוניות

- **פירוט טכני**:
  - הוצאת לוגיקת טעינת וידאו והגדרות לקומפוננטות נפרדות (`src/main.ts`). הוסרו פונקציות ישנות והוחלפו בפונקציות `loadVideoElement` ו-`loadSettingsElement`.
  - הוספת תמיכה בהפעלת אפליקציות חיצוניות דרך Fully Kiosk במקום הצגת סרטון (`src/lib/game-handler.ts`). שונתה הפונקציה `handleGameLevelEnd` ל-`handleGameTurn` והיא עודכנה לטיפול בשני המצבים. נוספה פונקציה `injectCodeToGame`.
  - שיפורים ועדכונים בקוד הזרקת הסקריפט למשחקים (`src/lib/game-handler.ts`, `src/lib/get-game-config.ts`).
  - עדכון הגדרות Fully Kiosk (`src/types.ts`). נוספו `FullyItem` ואינטרפייס `FullyKiosk` הורחב. עודכן `VideoDialogProps` ו-`Config`. נוסף `ConfigOverrides`.
  - עדכוני תלויות (`.gitignore`, `dev/.http`, `dev/game-list.js`, `svelte.config.js`, `tailwind.config.js`, `user-script-inject.js`).

- **למה**:
  - שיפור ארגון הקוד על ידי הפרדת הלוגיקה של טעינת הווידאו וההגדרות לקומפוננטות נפרדות.
  - הוספת גמישות למערכת על ידי מתן אפשרות להפעיל אפליקציות חיצוניות במקום להציג סרטון, בהתאם להגדרות.
  - שיפור הקוד המוזרק למשחקים והתאמתו לשינויים במבנה הקוד.
  - עדכון ההגדרות והטיפוסים בהתאם לשינויים שנעשו.

- **השפעות**:
  - המערכת תומכת כעת בשני מצבי פעולה: הצגת סרטון או הפעלת אפליקציה חיצונית.
  - שיפור בארגון הקוד ובחלוקתו לקומפוננטות.
  - שיפור ביכולת ההרחבה של המערכת בעתיד.